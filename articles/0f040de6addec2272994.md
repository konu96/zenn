---
title: "Cloud Native Buildpack ã§ Nuxt.js ãŒå‹•ã Docker ã‚³ãƒ³ãƒ†ãƒŠã‚’ä½œã‚‹"
emoji: "ğŸ˜½"
type: "tech" # tech: æŠ€è¡“è¨˜äº‹ / idea: ã‚¢ã‚¤ãƒ‡ã‚¢
topics: []
published: false
---

# ãã£ã‹ã‘

[Dockerfileã®ãƒ™ã‚¹ãƒˆãƒ—ãƒ©ã‚¯ãƒ†ã‚£ã‚¹ã¨ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ã«ã¤ã„ã¦](https://tech.enigmo.co.jp/entry/2020/12/17/100000) ã‚’èª­ã‚“ã§ã€ Cloud Native Buildpacks(ä»¥ä¸‹ã€CNB) ã®å­˜åœ¨ã‚’çŸ¥ã‚Šã¾ã—ãŸã€‚
ã¨ã¦ã‚‚ç°¡å˜ã« Docker ã‚³ãƒ³ãƒ†ãƒŠã‚’ä½œã£ã¦ã„ãŸã®ã§ã€è‡ªåˆ†ãŒã‚ˆãè§¦ã‚‹ Nuxt.js ã¯ã©ã†ã‚„ã£ã¦ã‚„ã‚‹ã‚“ã ã‚ã†ã¨æ€ã„è©¦ã—ã¦ã¿ã¾ã—ãŸã€‚

## äº‹å‰æº–å‚™

`Docker` ã¨ `Buildpack`ã€ `Nuxt.js` ãŒå¿…è¦ã«ãªã‚Šã¾ã™ã€‚ç’°å¢ƒãŒãªã„å ´åˆã¯ã€ä¸‹è¨˜ã‚’å‚è€ƒã«ã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—ã—ã¦ãã ã•ã„ã€‚

- [Docker](https://docs.docker.com/docker-for-mac/install/)
- [Buildpack](https://buildpacks.io/docs/tools/pack/)
- [Node](https://hirooooo-lab.com/development/nstall-node/#toc1)

## Docker ã‚¤ãƒ¡ãƒ¼ã‚¸ã®ä½œæˆ

1. `npx create-nuxt-app` ã§ Nuxt.js ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã‚’ä½œæˆã™ã‚‹

`npx create-nuxt-app` ã‚³ãƒãƒ³ãƒ‰ã‚’ä½¿ã†äº‹ã§ã€Nuxt.js ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã‚’ã‚¤ãƒ³ã‚¿ãƒ©ã‚¯ã‚·ãƒ§ãƒ³å½¢å¼ã§ä½œæˆã§ãã¾ã™ã€‚

2. Nuxt.js ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆå†…ã§ã€ä¸‹è¨˜ã‚³ãƒãƒ³ãƒ‰ã‚’å®Ÿè¡Œã™ã‚‹

```bash
pack build ${ä½œæˆã™ã‚‹ Docker ã‚¤ãƒ¡ãƒ¼ã‚¸å} --builder gcr.io/buildpacks/builder:v1
```

builder ã«ã¯ã€ä»–ã«ã‚‚æ¬¡ã®ã‚‚ã®ãŒç”¨æ„ã•ã‚Œã¦ã„ã¾ã™ã€‚ä»Šå›ã¯ã€ä¸€ç•ªä¸Šã§ã‚ªã‚¹ã‚¹ãƒ¡ã•ã‚Œã¦ã„ã‚‹ `gcr.io/buildpacks/builder:v1` ã‚’ä½¿ç”¨ã—ã¦ã„ãã¾ã™ã€‚

```
Google:                gcr.io/buildpacks/builder:v1      Ubuntu 18 base image with buildpacks for .NET, Go, Java, Node.js, and Python
Heroku:                heroku/buildpacks:18              heroku-18 base image with buildpacks for Ruby, Java, Node.js, Python, Golang, & PHP
Paketo Buildpacks:     paketobuildpacks/builder:base     Ubuntu bionic base image with buildpacks for Java, .NET Core, NodeJS, Go, Ruby, NGINX and Procfile
Paketo Buildpacks:     paketobuildpacks/builder:full     Ubuntu bionic base image with buildpacks for Java, .NET Core, NodeJS, Go, PHP, Ruby, Apache HTTPD, NGINX and Procfile
Paketo Buildpacks:     paketobuildpacks/builder:tiny     Tiny base image (bionic build image, distroless-like run image) with buildpacks for Java Native Image and Go
```

## Docker ã‚³ãƒ³ãƒ†ãƒŠã®ä½œæˆ

æ¬¡ã¯ã€Docker ã‚³ãƒ³ãƒ†ãƒŠã‚’ä½œã£ã¦ã„ãã¾ã™ã€‚
ä¸Šè¨˜ã§ä½œæˆã—ãŸ Docker ã‚¤ãƒ¡ãƒ¼ã‚¸ã¯ã€ `npm start` ãŒå®Ÿè¡Œã•ã‚Œã¾ã™ã€‚å‹•ä½œã‚’ç¢ºèªã™ã‚‹ã ã‘ãªã‚‰å•é¡Œãªã„ã§ã™ãŒã€é–‹ç™ºã‚’ã™ã‚‹ã¨ãƒ›ãƒƒãƒˆãƒªãƒ­ãƒ¼ãƒ‰ãŒåŠ¹ã‹ãªã„ã§ã™ã€‚ãã®ãŸã‚ã€`package.json` ã® `scripts` ã‚’æ¬¡ã®ã‚ˆã†ã«ä¿®æ­£ã—ã¾ã™ã€‚
`NUXT_HOST=0.0.0.0` ã‚’æŒ‡å®šã—ã¦ã„ã‚‹ã®ã¯ã€ãƒ›ã‚¹ãƒˆå´ã‹ã‚‰ `localhost` ã§ã‚¢ã‚¯ã‚»ã‚¹ã§ãã‚‹ã‚ˆã†ã«ã™ã‚‹ãŸã‚ã§ã™ã€‚(`package.json` ã‚’ä¿®æ­£ã™ã‚‹ã¨é–“é•ã£ã¦ commit ã™ã‚‹å±é™ºæ€§ãŒã‚ã‚‹ã®ã§ã€ä»–ã®æ–¹æ³•ãŒã‚ã‚‹å ´åˆã¯æ•™ãˆã¦ãã ã•ã„ğŸ™‡â€â™€ï¸)

```bash
- "start": "nuxt-ts start" 
+ "start": "NUXT_HOST=0.0.0.0 nuxt-ts"
``` 

ã‚ã¨ã¯ã€`docker run` ã§ã‚³ãƒ³ãƒ†ãƒŠã‚’ä½œæˆã™ã‚Œã° Nuxt.js ã‚’ Docker ã‚³ãƒ³ãƒ†ãƒŠå†…ã§é–‹ç™ºã™ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚

```bash
docker run -v ${ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªãƒ‘ã‚¹}:/workspace --name nuxt ${ä½œæˆã—ãŸ Docker ã‚¤ãƒ¡ãƒ¼ã‚¸å}
```