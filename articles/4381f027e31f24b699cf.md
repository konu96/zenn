---
title: "GAS ã§èº“ã„ãŸãƒ¡ãƒ¢"
emoji: "ğŸ’¬"
type: "tech"
topics: ["GAS", "Google App Script"]
published: true
---

# æ¦‚è¦
åˆã‚ã¦ GAS ã‚’è§¦ã£ã¦ã€ã„ãã¤ã‹èº“ã„ãŸã®ã§ãƒ¡ãƒ¢ã‚’æ®‹ã—ã¦ãŠãã€‚

## URL ã‚¯ãƒ©ã‚¹ã‚„ URLSearchParams ãŒãªã„

JavaScript ã§ API ã‹ã‚‰ãƒ‡ãƒ¼ã‚¿ã‚’å–å¾—ã™ã‚‹å ´åˆã€`URL` ã‚¯ãƒ©ã‚¹ã¨ `URLSearchParams` ã‚¯ãƒ©ã‚¹ã‚’ä½¿ã£ã¦ URL ã‚’çµ„ã¿ç«‹ã¦ `fetch` é–¢æ•°ãªã©ã‚’ä½¿ã†ã“ã¨ãŒå¤šã„ã€‚
ãŸã ã€GAS ã§ã¯ `URL` ã‚¯ãƒ©ã‚¹ã¨ `URLSearchParams` ã‚¯ãƒ©ã‚¹ãŒãªã‹ã£ãŸã®ã§ ã€ã‚¯ã‚¨ãƒªãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ãƒ¼ã‚’ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã‹ã‚‰ä½œã‚‹é–¢æ•°ã‚’è‡ªä½œã—ãŸã€‚

```typescript
const makeQueryString = (obj: object, encode: boolean = true): string => {
    return Object.keys(obj).map(key => {
        if (encode) {
            return `${key}=${encodeURIComponent(obj[key])}`;
        } else {
            return `${key}=${obj[key]}`;
        }
    }).join('&');
}

export default makeQueryString
```

## ç’°å¢ƒå¤‰æ•°ã¯ `PropertiesService` ã‚’ä½¿ã†

GAS ã§ç’°å¢ƒå¤‰æ•°ã‚’ä½¿ã†ã«ã¯ `PropertiesService` ã‚’ä½¿ã†ã€‚

```javascript
const accessToken = PropertiesService.getProperty('ACCESS_TOKEN');
```

## ã‚»ãƒ«ã‚„ã‚«ãƒ©ãƒ ã¯ 1 ã‹ã‚‰ã‚¹ã‚¿ãƒ¼ãƒˆ

ã‚»ãƒ«ã«ã‚¢ã‚¯ã‚»ã‚¹ã™ã‚‹ãŸã‚ã« `getRange` ãƒ¡ã‚½ãƒƒãƒ‰ãŒç”¨æ„ã•ã‚Œã¦ã„ã‚‹ãŒã€æ³¨æ„ãŒå¿…è¦ã§ã‚ã‚‹ã€‚
å¤šãã®ãƒ—ãƒ­ã‚°ãƒ©ãƒŸãƒ³ã‚°è¨€èªã¯ã€é…åˆ—ã‚„ãƒªã‚¹ãƒˆã®ä¸€ç•ªæœ€åˆã‚’ `0` ã¨ã—ã¦æ‰±ã†ã€‚ãã®ãŸã‚ã€ `A1` ã‚»ãƒ«ã‚’å–å¾—ã™ã‚‹ãŸã‚ã«ã¯ `getRange(0, 0)` ã§è‰¯ã„ã¨æ€ã£ãŸãŒã‚¨ãƒ©ãƒ¼ã«ãªã‚‹ã€‚
`getRange` ãƒ¡ã‚½ãƒƒãƒ‰ã«æ¸¡ã™ `row` ã¨ `column` ã¯ `1` ä»¥ä¸Šã®å€¤ã§ã‚ã‚‹å¿…è¦ãŒã‚ã‚‹ã€‚

```javascript
const sheet = SpreadsheetApp.getActiveSheet();

const value = sheet.getRange(0, 0).getValue();  // NG
const value = sheet.getRange(1, 1).getValue();  // OK
```

`sheet.getRange(1, 1)` ã§ `A1` ã‚»ãƒ«ã«ã‚¢ã‚¯ã‚»ã‚¹ã§ãã‚‹ã€‚

![](https://storage.googleapis.com/zenn-user-upload/f5s4jihg0k1zlc84l55y73mygixm)
